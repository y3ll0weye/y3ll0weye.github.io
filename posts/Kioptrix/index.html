<!DOCTYPE html><html lang="en" class="scroll-smooth" data-astro-cid-sckkx6r4> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="canonical" href="https://astro-paper.pages.dev/posts/Kioptrix/"><meta name="generator" content="Astro v5.7.10"><!-- General Meta Tags --><title>Kioptrix | y3ll0weye</title><meta name="title" content="Kioptrix | y3ll0weye"><meta name="description" content="Gain root access on this vulnerable machine. Enumerate to find the vulnerablilities and then exploit them to pwn the machine."><meta name="author" content="y3ll0weye"><link rel="sitemap" href="/sitemap-index.xml"><!-- Open Graph / Facebook --><meta property="og:title" content="Kioptrix | y3ll0weye"><meta property="og:description" content="Gain root access on this vulnerable machine. Enumerate to find the vulnerablilities and then exploit them to pwn the machine."><meta property="og:url" content="https://astro-paper.pages.dev/posts/Kioptrix/"><meta property="og:image" content="https://astro-paper.pages.dev/posts/Kioptrix/index.png"><!-- Article Published/Modified time --><meta property="article:published_time" content="2024-11-21T00:00:00.000Z"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://astro-paper.pages.dev/posts/Kioptrix/"><meta property="twitter:title" content="Kioptrix | y3ll0weye"><meta property="twitter:description" content="Gain root access on this vulnerable machine. Enumerate to find the vulnerablilities and then exploit them to pwn the machine."><meta property="twitter:image" content="https://astro-paper.pages.dev/posts/Kioptrix/index.png"><!-- Google JSON-LD Structured data --><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Kioptrix | y3ll0weye","image":"https://astro-paper.pages.dev/posts/Kioptrix/index.png","datePublished":"2024-11-21T00:00:00.000Z","author":[{"@type":"Person","name":"y3ll0weye"}]}</script><!-- Enable RSS feed auto-discovery  --><!-- https://docs.astro.build/en/recipes/rss/#enabling-rss-feed-auto-discovery --><link rel="alternate" type="application/rss+xml" title="y3ll0weye" href="https://astro-paper.pages.dev/rss.xml"><meta name="theme-color" content=""><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/_astro/ClientRouter.astro_astro_type_script_index_0_lang.BZs-2RF_.js"></script><script src="/toggle-theme.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css"><link rel="stylesheet" href="/_astro/about.BO8GGUk8.css">
<style>@keyframes astroFadeInOut{0%{opacity:1}to{opacity:0}}@keyframes astroFadeIn{0%{opacity:0;mix-blend-mode:plus-lighter}to{opacity:1;mix-blend-mode:plus-lighter}}@keyframes astroFadeOut{0%{opacity:1;mix-blend-mode:plus-lighter}to{opacity:0;mix-blend-mode:plus-lighter}}@keyframes astroSlideFromRight{0%{transform:translate(100%)}}@keyframes astroSlideFromLeft{0%{transform:translate(-100%)}}@keyframes astroSlideToRight{to{transform:translate(100%)}}@keyframes astroSlideToLeft{to{transform:translate(-100%)}}@media (prefers-reduced-motion){::view-transition-group(*),::view-transition-old(*),::view-transition-new(*){animation:none!important}[data-astro-transition-scope]{animation:none!important}}
:where([data-astro-image]){object-fit:var(--fit);object-position:var(--pos);height:auto}:where([data-astro-image=full-width]){width:100%}:where([data-astro-image=constrained]){max-width:100%}
</style><style>[data-astro-transition-scope="astro-fam6wyqg-1"] { view-transition-name: kioptrix; }@layer astro { ::view-transition-old(kioptrix) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(kioptrix) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(kioptrix) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(kioptrix) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-fam6wyqg-1"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-fam6wyqg-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-fam6wyqg-1"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-fam6wyqg-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-fam6wyqg-1"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-fam6wyqg-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-fam6wyqg-1"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-fam6wyqg-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style><style>[data-astro-transition-scope="astro-36ssibgs-2"] { view-transition-name: others; }@layer astro { ::view-transition-old(others) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(others) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(others) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(others) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-2"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-2"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-2"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-2"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style></head> <body data-astro-cid-sckkx6r4>  <header> <a id="skip-to-content" href="#main-content" class="absolute -top-full left-16 z-50 bg-background px-3 py-2 text-accent backdrop-blur-lg transition-all focus:top-4">
Skip to content
</a> <div id="nav-container" class="mx-auto flex max-w-3xl flex-col items-center justify-between sm:flex-row"> <div id="top-nav-wrap" class="relative flex w-full items-baseline justify-between bg-background p-4 sm:items-center sm:py-6"> <a href="/" class="absolute py-1 text-2xl leading-7 font-semibold whitespace-nowrap sm:static"> y3ll0weye </a> <nav id="nav-menu" class="flex w-full flex-col items-center sm:ml-2 sm:flex-row sm:justify-end sm:space-x-4 sm:py-0"> <button id="menu-btn" class="focus-outline self-end p-2 sm:hidden" aria-label="Open Menu" aria-expanded="false" aria-controls="menu-items"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="hidden" id="close-icon"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M18 6l-12 12" /><path d="M6 6l12 12" /></svg> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-menu-deep" id="menu-icon"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M4 6h16" /><path d="M7 12h13" /><path d="M10 18h10" /></svg> </button> <ul id="menu-items" class="mt-4 grid w-44 grid-cols-2 place-content-center gap-2 [&#38;>li>a]:block [&#38;>li>a]:px-4 [&#38;>li>a]:py-3 [&#38;>li>a]:text-center [&#38;>li>a]:font-medium [&#38;>li>a]:hover:text-accent sm:[&#38;>li>a]:px-2 sm:[&#38;>li>a]:py-1 hidden sm:mt-0 sm:ml-0 sm:flex sm:w-auto sm:gap-x-5 sm:gap-y-0"> <li class="col-span-2"> <a href="/posts" class="active-nav">
Posts
</a> </li> <li class="col-span-2"> <a href="/tags">
Tags
</a> </li> <li class="col-span-2"> <a href="/about">
About
</a> </li> <li class="col-span-2"> <a href="/archives" class="group inline-block hover:text-accent focus-outline flex justify-center p-3 sm:p-1" aria-label="archives" title="Archives"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="hidden sm:inline-block"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M3 4m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v0a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z" /><path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" /><path d="M10 12l4 0" /></svg> <span class="sm:sr-only">Archives</span> </a> </li> <li class="col-span-1 flex items-center justify-center"> <a href="/search" class="group inline-block hover:text-accent focus-outline flex p-3 sm:p-1" aria-label="search" title="Search"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-search"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg> <span class="sr-only">Search</span> </a> </li> <li class="col-span-1 flex items-center justify-center"> <button id="theme-btn" class="focus-outline relative size-12 p-4 sm:size-8 hover:[&>svg]:stroke-accent" title="Toggles light & dark" aria-label="auto" aria-live="polite"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="absolute top-[50%] left-[50%] -translate-[50%] scale-100 rotate-0 transition-all dark:scale-0 dark:-rotate-90"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" /></svg> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="absolute top-[50%] left-[50%] -translate-[50%] scale-0 rotate-90 transition-all dark:scale-100 dark:rotate-0"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M14.828 14.828a4 4 0 1 0 -5.656 -5.656a4 4 0 0 0 5.656 5.656z" /><path d="M6.343 17.657l-1.414 1.414" /><path d="M6.343 6.343l-1.414 -1.414" /><path d="M17.657 6.343l1.414 -1.414" /><path d="M17.657 17.657l1.414 1.414" /><path d="M4 12h-2" /><path d="M12 4v-2" /><path d="M20 12h2" /><path d="M12 20v2" /></svg> </button> </li> </ul> </nav> </div> </div> <div class="max-w-3xl mx-auto px-4"> <hr class="border-border" aria-hidden="true"> </div> </header> <script type="module">function s(){const e=document.querySelector("#menu-btn"),t=document.querySelector("#menu-items"),n=document.querySelector("#menu-icon"),o=document.querySelector("#close-icon");!e||!t||!n||!o||e.addEventListener("click",()=>{const c=e.getAttribute("aria-expanded")==="true";e.setAttribute("aria-expanded",c?"false":"true"),e.setAttribute("aria-label",c?"Open Menu":"Close Menu"),t.classList.toggle("hidden"),n.classList.toggle("hidden"),o.classList.toggle("hidden")})}s();document.addEventListener("astro:after-swap",s);</script> <div class="mx-auto flex w-full max-w-3xl items-center justify-start px-2"><a id="back-button" href="/" class="group inline-block hover:text-accent focus-outline mt-8 mb-2 flex hover:text-foreground/75"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M15 6l-6 6l6 6" /></svg><span>Go back</span></a></div><script type="module">function o(){const t=document.querySelector("#back-button"),e=sessionStorage.getItem("backUrl");e&&t&&(t.href=e)}document.addEventListener("astro:page-load",o);o();</script> <main id="main-content" class="mx-auto w-full max-w-3xl px-4 pb-12" data-pagefind-body> <h1 class="inline-block text-2xl font-bold text-accent sm:text-3xl" data-astro-transition-scope="astro-fam6wyqg-1"> Kioptrix </h1> <div class="flex items-center gap-4"> <div class="flex items-end space-x-2 opacity-80 my-2"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 min-w-[1.375rem]"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z" /><path d="M16 3v4" /><path d="M8 3v4" /><path d="M4 11h16" /><path d="M7 14h.013" /><path d="M10.01 14h.005" /><path d="M13.01 14h.005" /><path d="M16.015 14h.005" /><path d="M13.015 17h.005" /><path d="M7.01 17h.005" /><path d="M10.01 17h.005" /></svg> <span class="sr-only">Published:</span> <span class="text-sm italic sm:text-base"> <time datetime="2024-11-21T00:00:00.000Z">21 Nov, 2024</time> <span aria-hidden="true"> | </span> <span class="sr-only">&nbsp;at&nbsp;</span> <span class="text-nowrap">07:00 AM</span> </span> </div>  </div> <article id="article" class="mx-auto prose mt-8 max-w-3xl"> <h1 id="kioptrix">Kioptrix</h1>
<hr>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix1.png" alt="picture"></p>
<ul>
<li>We will be attempting to gain root access to Kioptrix</li>
</ul>
<p>Going into our kali machine we determine our ip with <code>ifconfig</code> and then use the command <code>netdiscover -r x.y.z.0/24</code> which uses address resolution protocol to discover every ip address on the subnet of 24.</p>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix3.png" alt="picture"></p>
<ul>
<li>we can see the ip of the target machine</li>
</ul>
<h2 id="nmap-nmap">Nmap #Nmap</h2>
<hr>
<p>SYN (hey port are you open) —> SYNACK (yeah I’m open lets make the connection) —> ACK (<em>makes connection</em>)</p>
<ul>
<li>we can use Nmap which identifies open ports similar to the three way handshake</li>
<li>Nmap follows SYN —> SYNACK but changes to SYNACK —> RST</li>
<li>this means instead of connecting to the port it simply shows us which ports are open</li>
</ul>
<p>We can do <code>nmap -T4 -p- -A &#x3C;ip></code>, where <code>-T4</code> represents the speed, 1 being the slowest and 5 being the fastest. Slower is better for detection but it is slow. <code>-p-</code> means i want to scan all ports, without -p- we will scan the 1000 most common ports however that leaves 64535 ports left unscanned. <code>-A</code> stands for everything, version info, operating system, etc.</p>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix28.png" alt="picture"></p>
<p>The Nmap scan shows us a lot of important information such as the different ports and the services running on them as well as the version.</p>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix20.png" alt="picture"></p>
<ul>
<li>is the rest of the information</li>
</ul>
<h2 id="enumerating-httphttps-http-https">Enumerating HTTP/HTTPS #http #https</h2>
<hr>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix5.png" alt="picture"></p>
<ul>
<li>port 443 is open and running https so…</li>
<li>let’s try to add a security exception</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix6.png" alt="picture"></p>
<ul>
<li>not working…
<img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix7.png" alt="picture"></li>
<li>still not working…
<img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix8.png" alt="picture"></li>
<li>I’m not even sure if it is possible to work</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix9.png" alt="picture"></p>
<ul>
<li>even another browser does not work i give up</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix10.png" alt="picture"></p>
<ul>
<li>at least http works</li>
</ul>
<p>The default webpage hints at poor hygiene. Are there hidden directories behind this?, is there another host?, if not why is this page still up, signals the admin is lazy and potentially left more vulnerabilities.</p>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix11.png" alt="picture">
404 page showing us a bit more information than it should.</p>
<p>We can run <code>nikto</code> which is a web vulnerability scanning tool.
<img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix12.png" alt="picture">
<img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix13.png" alt="picture">
We can see the Apache version is outdated and open to exploits as well as OpenSSL.
<img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix14.png" alt="picture"></p>
<p>Now let’s directory bust to try and find some interesting files on our target’s web application.</p>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix15.png" alt="picture"></p>
<p>File extensions help us narrow down the search, Apache usually runs php and Microsoft usually runs asp, this info is important to gather during enumeration
.txt, .zip, .rar are other examples of common files</p>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix16.png" alt="picture"></p>
<p>in the responses section, 200s usually mean response is fine, 300s is a redirect, 400s are response errors and 500s are server errors</p>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix17.png" alt="picture"></p>
<p>might be an interesting file</p>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix18.png" alt="picture">
always scroll to the bottom of the page, we can see we have Webalizer version 2.01 which might have known exploits</p>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix19.png" alt="picture">
seems to be a list of folders and directories, could be interesting</p>
<h2 id="enumerating-smb-smb">Enumerating SMB #smb</h2>
<hr>
<p>SMB is a file share, consider the scans folder, when you scan something on a printer and it magically appears in your scans folder that is an example of SMB. A lot of internal exploits such as MS17010.</p>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix28.png" alt="picture"></p>
<ul>
<li>refresher of the nmap scan which shows SMB open on port 139</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix20.png" alt="picture"></p>
<ul>
<li><code>-A</code> shows us extra info with Host script results</li>
<li>we can see the SMB version (SMB2) which may have known exploits</li>
</ul>
<p>In Metasploit we can search for smb
<img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix21.png" alt="picture"></p>
<ul>
<li>shows us important info on the service as well as the exploit info</li>
<li>if we want to use 389 we can enter <code>use 389</code> or <code>use auxiliary/scanner/smb/smb_version</code></li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix22.png" alt="picture"></p>
<ul>
<li><code>info</code> shows us what we are doing in the module</li>
<li>RHOSTS and RPORT refers to the target hosts and port</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix23.png" alt="picture"></p>
<ul>
<li>we have set the RHOSTS with the target IP and found the Samba version</li>
</ul>
<p><code>smbclient</code> allows us to connect to the file share possibly with anonymous access. A list of files on the server and the information inside will be huge in the exploitation phase of the mission.
<img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix24.png" alt="picture"></p>
<ul>
<li>anonymous login is successful and we are able to see filenames</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix25.png" alt="picture"></p>
<ul>
<li>we cannot access the ADMIN$ file</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix26.png" alt="picture"></p>
<ul>
<li>we’re in! :)</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix27.png" alt="picture"></p>
<ul>
<li>and now we’ve hit a dead end :/</li>
</ul>
<h2 id="enumerating-ssh-ssh">Enumerating SSH #ssh</h2>
<hr>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix28.png" alt="picture"></p>
<ul>
<li>refresh of nmap scan which shows ssh open on port 22</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix102.png" alt="picture"></p>
<ul>
<li>we have simply used ssh to connect</li>
<li>again once we guess a password we are moving onto the exploitation phase</li>
</ul>
<h2 id="researching-potential-vulns">Researching Potential Vulns</h2>
<hr>
<p>80/443 and 139/445 are the most vulnerable usually so we should research those first. Remember the <code>nikto</code> scan which showed us that Apache mod_ssl 2.8.4 was potentially vulnerable.</p>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix29.png" alt="picture"></p>
<ul>
<li><a href="https://www.cvedetails.com/">https://www.cvedetails.com/</a> is a good place to look at scorings of potential vulnerabilities</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix30.png" alt="picture"></p>
<ul>
<li>that link is popping up again</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix31.png" alt="picture"></p>
<ul>
<li>now we are looking for samba 2.2.1a exploit</li>
<li>Rapid7 is always nice to see since it makes Metasploit</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix32.png" alt="picture"></p>
<ul>
<li>the version number fits</li>
<li>we did get anonymous access to IPC$</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix33.png" alt="picture"></p>
<ul>
<li>shows us how to exploit within the frameworks of Metasploit</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix34.png" alt="picture"></p>
<ul>
<li><code>seachsploit</code> allows us to search for the same exploits as on ExploitDB if we don’t have internet connection or are in a pinch</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix35.png" alt="picture"></p>
<ul>
<li><code>searchsploit mod ssl 2</code> shows us exploits for mod_ssl 2</li>
<li>we can see on the RHS that remote is a big look for us</li>
</ul>
<h2 id="scanning-with-nessus-nessus">Scanning with Nessus #nessus</h2>
<hr>
<p>After downloading Nessus from the terminal we can go to the Downloads folder and run <code>dpkg -i &#x3C;Nessus_filename></code>. Run the given command then access the https page, accessing the page without running the command will not give you the option to bypass the security certificate.</p>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix36.png" alt="picture"></p>
<ul>
<li>running a basic Nessus scan with the Kioptrix ip yields us many possible vulnerabilities</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix37.png" alt="picture"></p>
<ul>
<li>it seems that SSL itself is vulnerable and we can exploit it</li>
<li>important to note that Nessus doesn’t tell us how to exploit it directly we need to do our own research</li>
</ul>
<h2 id="reverse-shells-vs-bind-shells">Reverse shells vs. Bind shells</h2>
<hr>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix38.png" alt="picture"></p>
<ul>
<li>A shell is simply access to a machine</li>
<li>A reverse shell means the target connects to us</li>
<li>In the picture we have setup a listener with netcat on our machine, <code>-lvnp 4444</code> means listening on port 4444 with verbose results</li>
<li>the target machine is connecting to our ip on port 4444 and then execute <code>/bin/sh</code> which is a Linux machine</li>
<li>if it was a windows machine <code>/bin/sh</code> ---> <code>cmd.exe</code></li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix39.png" alt="picture"></p>
<ul>
<li>in a bind shell we open a port on the machine then connect to it</li>
<li>the target machine deploys the listener this time</li>
<li>the execution, <code>-e /bin/sh</code> still happens on the target</li>
</ul>
<h2 id="staged-vs-nonstaged-payloads">Staged vs. Nonstaged #payloads</h2>
<hr>
<p>A payload is what we run as an exploit. This is what we send to the victim and attempt to get a shell on their machine.</p>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix40.png" alt="picture"></p>
<ul>
<li>we can see the stages are separated by a slash</li>
<li>not every payload works we need to try out different combos, e.g. bind shell + Staged or reverse shell + Non-staged</li>
</ul>
<h2 id="gaining-root-w-metasploit">Gaining root w/ #Metasploit</h2>
<hr>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix41.png" alt="picture"></p>
<ul>
<li>remember we searched samba 2.2 vulns (smb on port 139) and a few came up so let’s target samba</li>
<li>we had the IPC$ anon connection so this is a good place to start</li>
<li>we also had found trans2open on Rapid7 in our enumeration process</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix42.png" alt="picture"></p>
<ul>
<li>our enumeration showed us that the target is a Linux machine so we know which module to choose</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix43.png" alt="picture"></p>
<ul>
<li>after doing <code>use 1</code> we are given the option to set the RHOST so we go ahead and do that</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix44.png" alt="picture"></p>
<ul>
<li>what is happening here?</li>
<li>Metasploit is trying brute force attacks on different return addresses until it finds one it can send the payload/stage to</li>
<li>However the stage keeps dying</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix45.png" alt="picture"></p>
<ul>
<li>cancelling the operation and going back to options we see we have a new option</li>
<li>we are running a staged payload as seen by the <code>linux/x86/meterpreter/reverse_tcp</code></li>
<li>we can do <code>set payload linux/x86</code> and then hit TAB twice to see the payload options</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix46.png" alt="picture"></p>
<ul>
<li>we have switched to a non-staged payload</li>
<li>let’s run this payload now</li>
</ul>
<p><img src="https://raw.githubusercontent.com/tedthecaver/tedthecaver.github.io/main/_posts/Kioptrix47.png" alt="picture"></p>
<ul>
<li>and it worked! we are root :)</li>
</ul> </article> <hr class="my-8 border-dashed">  <ul class="mt-4 mb-8 sm:my-8"> <li class="group inline-block group-hover:cursor-pointer my-1 underline-offset-4"> <a href="/tags/others/" class="relative pr-2 text-lg underline decoration-dashed group-hover:-top-0.5 group-hover:text-accent focus-visible:p-1 text-sm" data-astro-transition-scope="astro-36ssibgs-2"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block opacity-80 -mr-3.5 size-4"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M5 9l14 0" /><path d="M5 15l14 0" /><path d="M11 4l-4 16" /><path d="M17 4l-4 16" /></svg>
&nbsp;<span>others</span> </a> </li> </ul> <div class="flex flex-col items-center justify-between gap-6 sm:flex-row sm:items-end sm:gap-4"> <div class="flex flex-col flex-wrap items-center justify-center gap-1 sm:items-start"> <span class="italic">Share this post on:</span> <div class="text-center"> <a href="https://wa.me/?text=https://astro-paper.pages.dev/posts/Kioptrix/" class="group inline-block hover:text-accent scale-90 p-2 hover:rotate-6 sm:p-1" title="Share this post via WhatsApp"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M3 21l1.65 -3.8a9 9 0 1 1 3.4 2.9l-5.05 .9" /><path d="M9 10a.5 .5 0 0 0 1 0v-1a.5 .5 0 0 0 -1 0v1a5 5 0 0 0 5 5h1a.5 .5 0 0 0 0 -1h-1a.5 .5 0 0 0 0 1" /></svg> <span class="sr-only">Share this post via WhatsApp</span> </a><a href="https://www.facebook.com/sharer.php?u=https://astro-paper.pages.dev/posts/Kioptrix/" class="group inline-block hover:text-accent scale-90 p-2 hover:rotate-6 sm:p-1" title="Share this post on Facebook"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M7 10v4h3v7h4v-7h3l1 -4h-4v-2a1 1 0 0 1 1 -1h3v-4h-3a5 5 0 0 0 -5 5v2h-3" /></svg> <span class="sr-only">Share this post on Facebook</span> </a><a href="https://x.com/intent/post?url=https://astro-paper.pages.dev/posts/Kioptrix/" class="group inline-block hover:text-accent scale-90 p-2 hover:rotate-6 sm:p-1" title="Share this post on X"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M4 4l11.733 16h4.267l-11.733 -16z" /><path d="M4 20l6.768 -6.768m2.46 -2.46l6.772 -6.772" /></svg> <span class="sr-only">Share this post on X</span> </a><a href="https://t.me/share/url?url=https://astro-paper.pages.dev/posts/Kioptrix/" class="group inline-block hover:text-accent scale-90 p-2 hover:rotate-6 sm:p-1" title="Share this post via Telegram"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M15 10l-4 4l6 6l4 -16l-18 7l4 2l2 6l3 -4" /></svg> <span class="sr-only">Share this post via Telegram</span> </a><a href="https://pinterest.com/pin/create/button/?url=https://astro-paper.pages.dev/posts/Kioptrix/" class="group inline-block hover:text-accent scale-90 p-2 hover:rotate-6 sm:p-1" title="Share this post on Pinterest"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M8 20l4 -9" /><path d="M10.7 14c.437 1.263 1.43 2 2.55 2c2.071 0 3.75 -1.554 3.75 -4a5 5 0 1 0 -9.7 1.7" /><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /></svg> <span class="sr-only">Share this post on Pinterest</span> </a><a href="mailto:?subject=See%20this%20post&#38;body=https://astro-paper.pages.dev/posts/Kioptrix/" class="group inline-block hover:text-accent scale-90 p-2 hover:rotate-6 sm:p-1" title="Share this post via email"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M3 7a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-10z" /><path d="M3 7l9 6l9 -6" /></svg> <span class="sr-only">Share this post via email</span> </a> </div> </div> <button id="back-to-top" class="focus-outline py-1 whitespace-nowrap hover:opacity-75"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block rotate-90"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M15 6l-6 6l6 6" /></svg> <span>Back to Top</span> </button> </div> <hr class="my-6 border-dashed"> <!-- Previous/Next Post Buttons --> <div data-pagefind-ignore class="grid grid-cols-1 gap-6 sm:grid-cols-2"> <a href="/posts/Sentiment analysis part 1" class="flex w-full gap-1 hover:opacity-75"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block flex-none"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M15 6l-6 6l6 6" /></svg> <div> <span>Previous Post</span> <div class="text-sm text-accent/85">Sentiment analysis part 1</div> </div> </a> <a href="/posts/2024-11-09-banditlvl18" class="flex w-full justify-end gap-1 text-right hover:opacity-75 sm:col-start-2"> <div> <span>Next Post</span> <div class="text-sm text-accent/85">Bandit lvl 18-20</div> </div> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block flex-none"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M9 6l6 6l-6 6" /></svg> </a> </div> </main> <footer class="w-full mt-auto"> <div class="max-w-3xl mx-auto px-0"> <hr class="border-border" aria-hidden="true"> </div> <div class="flex flex-col items-center justify-between py-6 sm:flex-row-reverse sm:py-4"> <div class="flex-wrap justify-center gap-1 flex"> <a href="https://github.com/satnaing/astro-paper" class="group inline-block hover:text-accent p-2 hover:rotate-6 sm:p-1" title=" y3ll0weye on Github"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" /></svg> <span class="sr-only"> y3ll0weye on Github</span> </a><a href="https://www.linkedin.com/in/ibrahim-ahmed-b1bb50267/" class="group inline-block hover:text-accent p-2 hover:rotate-6 sm:p-1" title="y3ll0weye on LinkedIn"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M8 11v5" /><path d="M8 8v.01" /><path d="M12 16v-5" /><path d="M16 16v-3a2 2 0 1 0 -4 0" /><path d="M3 7a4 4 0 0 1 4 -4h10a4 4 0 0 1 4 4v10a4 4 0 0 1 -4 4h-10a4 4 0 0 1 -4 -4z" /></svg> <span class="sr-only">y3ll0weye on LinkedIn</span> </a><a href="ibrahim.a101@outlook.com" class="group inline-block hover:text-accent p-2 hover:rotate-6 sm:p-1" title="Send an email to y3ll0weye"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M3 7a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-10z" /><path d="M3 7l9 6l9 -6" /></svg> <span class="sr-only">Send an email to y3ll0weye</span> </a> </div> <div class="my-2 flex flex-col items-center whitespace-nowrap sm:flex-row"> <span>Copyright &#169; 2025</span> <span class="hidden sm:inline">&nbsp;|&nbsp;</span> <span>All rights reserved.</span> </div> </div> </footer>  </body></html> <script data-astro-rerun>
  /** Create a progress indicator
   *  at the top */
  function createProgressBar() {
    // Create the main container div
    const progressContainer = document.createElement("div");
    progressContainer.className =
      "progress-container fixed top-0 z-10 h-1 w-full bg-background";

    // Create the progress bar div
    const progressBar = document.createElement("div");
    progressBar.className = "progress-bar h-1 w-0 bg-accent";
    progressBar.id = "myBar";

    // Append the progress bar to the progress container
    progressContainer.appendChild(progressBar);

    // Append the progress container to the document body or any other desired parent element
    document.body.appendChild(progressContainer);
  }
  createProgressBar();

  /** Update the progress bar
   *  when user scrolls */
  function updateScrollProgress() {
    document.addEventListener("scroll", () => {
      const winScroll =
        document.body.scrollTop || document.documentElement.scrollTop;
      const height =
        document.documentElement.scrollHeight -
        document.documentElement.clientHeight;
      const scrolled = (winScroll / height) * 100;
      if (document) {
        const myBar = document.getElementById("myBar");
        if (myBar) {
          myBar.style.width = scrolled + "%";
        }
      }
    });
  }
  updateScrollProgress();

  /** Attaches links to headings in the document,
   *  allowing sharing of sections easily */
  function addHeadingLinks() {
    const headings = Array.from(
      document.querySelectorAll("h2, h3, h4, h5, h6")
    );
    for (const heading of headings) {
      heading.classList.add("group");
      const link = document.createElement("a");
      link.className =
        "heading-link ml-2 opacity-0 group-hover:opacity-100 focus:opacity-100";
      link.href = "#" + heading.id;

      const span = document.createElement("span");
      span.ariaHidden = "true";
      span.innerText = "#";
      link.appendChild(span);
      heading.appendChild(link);
    }
  }
  addHeadingLinks();

  /** Attaches copy buttons to code blocks in the document,
   * allowing users to copy code easily. */
  function attachCopyButtons() {
    const copyButtonLabel = "Copy";
    const codeBlocks = Array.from(document.querySelectorAll("pre"));

    for (const codeBlock of codeBlocks) {
      const wrapper = document.createElement("div");
      wrapper.style.position = "relative";

      const copyButton = document.createElement("button");
      copyButton.className =
        "copy-code absolute right-3 -top-3 rounded bg-muted px-2 py-1 text-xs leading-4 text-foreground font-medium";
      copyButton.innerHTML = copyButtonLabel;
      codeBlock.setAttribute("tabindex", "0");
      codeBlock.appendChild(copyButton);

      // wrap codebock with relative parent element
      codeBlock?.parentNode?.insertBefore(wrapper, codeBlock);
      wrapper.appendChild(codeBlock);

      copyButton.addEventListener("click", async () => {
        await copyCode(codeBlock, copyButton);
      });
    }

    async function copyCode(block, button) {
      const code = block.querySelector("code");
      const text = code?.innerText;

      await navigator.clipboard.writeText(text ?? "");

      // visual feedback that task is completed
      button.innerText = "Copied";

      setTimeout(() => {
        button.innerText = copyButtonLabel;
      }, 700);
    }
  }
  attachCopyButtons();

  /** Scrolls the document to the top when
   * the "Back to Top" button is clicked. */
  function backToTop() {
    document.querySelector("#back-to-top")?.addEventListener("click", () => {
      document.body.scrollTop = 0; // For Safari
      document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
    });
  }
  backToTop();

  /* Go to page start after page swap */
  document.addEventListener("astro:after-swap", () =>
    window.scrollTo({ left: 0, top: 0, behavior: "instant" })
  );
</script>